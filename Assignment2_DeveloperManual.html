<!DOCTYPE html>
<html class="wf-opensans-i3-active wf-opensans-i4-active wf-opensans-i6-active wf-opensans-i7-active wf-opensans-i8-active wf-opensans-n3-active wf-opensans-n4-active wf-opensans-n6-active wf-opensans-n7-active wf-opensans-n8-active wf-active wf-opensanscondensed-i3-active wf-opensanscondensed-n3-active wf-opensanscondensed-n7-active"><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<link rel="icon" href="http://15462.courses.cs.cmu.edu/fall2016/assets/images/favicon/dragon.png" type="image/png">
<title>Scotty3D Developer Manual : Computer Graphics : 15-462/662 Fall 2016</title>

<link rel="stylesheet" href="Assignment2_DeveloperManual_files/l_002.css" media="all"><link rel="stylesheet" href="Assignment2_DeveloperManual_files/l_004.css" media="all"><link rel="stylesheet" href="Assignment2_DeveloperManual_files/l_006.css" media="all"><link rel="stylesheet" href="Assignment2_DeveloperManual_files/l_008.css" media="all"><link rel="stylesheet" href="Assignment2_DeveloperManual_files/l_010.css" media="all"><script src="Assignment2_DeveloperManual_files/open-sansn3i3n4i4n6i6n7i7n8i8.js"></script>
<link rel="stylesheet" href="Assignment2_DeveloperManual_files/l.css" media="all"><link rel="stylesheet" href="Assignment2_DeveloperManual_files/l_003.css" media="all"><link rel="stylesheet" href="Assignment2_DeveloperManual_files/l_005.css" media="all"><link rel="stylesheet" href="Assignment2_DeveloperManual_files/l_007.css" media="all"><link rel="stylesheet" href="Assignment2_DeveloperManual_files/l_009.css" media="all"><script src="Assignment2_DeveloperManual_files/open-sans-condensedn3i3n7.js"></script>

<script src="Assignment2_DeveloperManual_files/jquery_002.js"></script>
<script src="Assignment2_DeveloperManual_files/jquery.js"></script>
<script src="Assignment2_DeveloperManual_files/jquery_003.js"></script>

<script src="Assignment2_DeveloperManual_files/codemirror.js"></script>
<script src="Assignment2_DeveloperManual_files/markdown.js"></script>

<script type="text/javascript" src="Assignment2_DeveloperManual_files/MathJax.js">
</script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>

<script type="text/x-mathjax-config;executed=true">
MathJax.Hub.Config({
  skipStartupTypeset: true,
  showProcessingMessages: false,
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script>


<link rel="stylesheet" type="text/css" href="Assignment2_DeveloperManual_files/codemirror.css">

<script src="Assignment2_DeveloperManual_files/prettify.js"></script>
<link rel="stylesheet" type="text/css" href="Assignment2_DeveloperManual_files/prettify.css">

<!-- NOTE(kayvonf): place at end to override 3rd party tools -->
<link rel="stylesheet" type="text/css" href="Assignment2_DeveloperManual_files/main.css">

<script type="text/javascript">
var edit_comment_url = "http://15462.courses.cs.cmu.edu/fall2016/comments/ajax_edit_comment";
var delete_comment_url = "http://15462.courses.cs.cmu.edu/fall2016/comments/ajax_delete_comment";
var archive_comment_url = "http://15462.courses.cs.cmu.edu/fall2016/comments/ajax_archive_comment";
var add_private_comment_url = "http://15462.courses.cs.cmu.edu/fall2016/comments/ajax_add_private_comment";
var add_instructor_comment_url = "http://15462.courses.cs.cmu.edu/fall2016/comments/ajax_add_instructor_comment";
var add_comment_url = "http://15462.courses.cs.cmu.edu/fall2016/comments/ajax_add_comment";
var comment_vote_url = "http://15462.courses.cs.cmu.edu/fall2016/comments/ajax_comment_vote";
var toggle_subscribe_url = "http://15462.courses.cs.cmu.edu/fall2016/comments/ajax_toggle_subscribe";
var prompt_students_url = "http://15462.courses.cs.cmu.edu/fall2016/comments/ajax_prompt_students";
var keep_alive_url = "http://15462.courses.cs.cmu.edu/fall2016/keep_alive";
</script>

<script type="text/javascript" src="Assignment2_DeveloperManual_files/main.js"></script>
<script type="text/javascript" src="Assignment2_DeveloperManual_files/comments.js"></script>

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.0') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.0') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.0') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.0') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.0') format('woff'), url('http://cdn.mathjax.org/mathjax/2.7-latest/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.0') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body><div id="MathJax_Message" style="display: none;"></div><div id="MathJax_Message" style="display: none;"></div><div id="MathJax_Message" style="display: none;"></div><div id="MathJax_Message" style="display: none;"></div><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

<div id="modal_overlay"></div>

<div class="main_container">

<div class="topbar">
<div class="topbar_left"><a href="http://www.cs.cmu.edu/%7E15462/">[Home]</a></div>
<div class="topbar_left"><a href="https://15462-s17.github.io/Scotty3D/Assignment2">[Back]</a></div>



<!-- <div class="topbar_left"><a href="http://15462.courses.cs.cmu.edu/fall2016/projects">[Projects]</a></div> -->





</div>

<div class="content_container">

<!-- end of header -->






<div class="article_container">

<div class="common_title title">Scotty3D Developer Manual</div>

<hr size="1">


<div class="markdown article-content">
<p><img src="Assignment2_DeveloperManual_files/Scotty3DLogo.svg" alt="Scotty3DLogo"></p>

<h2>Overview</h2>

<p>This document describes the internal data structures and algorithms 
that comprise the Scotty3D codebase, focusing mainly on core 
functionality (e.g., meshing and ray tracing).  Limited documentation of
 the graphical user interface (GUI) is available via comments in the 
source itself (though this information is not needed for assignments).</p>

<h2>Geometric Data Structures</h2>

<p>Scotty3D uses a variety of geometric data structures, depending on 
the task.  Some operations (e.g., ray tracing) use a simple list of 
triangles that can be compactly encoded and efficiently cached.  For 
more sophisticated geometric tasks like mesh editing and sampling, a 
simple triangle list is no longer sufficient (or leads to unnecessarily 
poor asymptotic performance).  Most actions in MeshEdit mode therefore 
use a topological data structure called a <em>halfedge mesh</em> (also known as a _doubly-connected edge list), which provides a good tradeoff between simplicity and sophistication.</p>

<h3>The Halfedge Data Structure</h3>

<p>The basic idea behind the halfedge data structure is that, in 
addition to the usual vertices, edges, and faces that make up a 
polygonal mesh, we also have an entity called a <em>halfedge</em> that 
acts like "glue" connecting the different elements.  It is this glue 
that allow us to easily "navigate" the mesh, i.e., easily access mesh 
elements adjacent to a given element.</p>

<p><img src="Assignment2_DeveloperManual_files/halfedgePointers.png" alt="halfedgePointers" height="216" width="382"></p>

<p>In particular, there are two halfedges associated with each edge (see
 picture above).  For an edge connecting two vertices i and j, one of 
its halfedges points from i to j; the other one points from j to i.  In 
other words, we say that the two halfedges are <em>oppositely oriented</em>.
  On of the halfedges is associated with the face to the "left" of the 
edge; the other is associated with the face to the "right."  Each 
halfedge knows about the opposite halfedge, which we call its <em>twin</em>.  It also knows about the <em>next</em> halfedge around its face, as well as its associated edge, face, and vertex.</p>

<p>In contrast, the standard mesh elements (vertices, edges, and faces) know only about <em>one</em> of their halfedges.  In particular:</p>

<ul>
<li>a vertex knows about one of its "outgoing" halfedges,</li>
<li>an edge knows about one of its two halfedges, and</li>
<li>a face knows about one of the many halfedges circulating around its interior.</li>
</ul>

<p>In summary, we have the following relationships:</p>

<p></p><center><p></p>

<table>
<thead>
<tr>
  <th>Mesh element</th>
  <th align="center">Pointers</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Vertex</td>
  <td align="center">one halfedge</td>
</tr>
<tr>
  <td>Edge</td>
  <td align="center">one halfedge</td>
</tr>
<tr>
  <td>Face</td>
  <td align="center">one halfedge</td>
</tr>
<tr>
  <td>Halfedge</td>
  <td align="center">twin, next, vertex, edge, face</td>
</tr>
</tbody>
</table>

<p></p></center><p></p>

<p>This list emphasizes that it is really the <strong>halfedges</strong>
 that connect everything up. An easy example is if we want to visit all 
the vertices of a given face.  We can start at the face's halfedge, and 
follow the "next" pointer until we're back at the beginning. A more 
interesting example is visiting all the vertices adjacent to a given 
vertex v. We can start by getting its outgoing halfedge, then its twin, 
then its next halfedge; this final halfedge will also point out of 
vertex v, but it will point <strong>toward</strong> a different vertex than the first halfedge. By repeating this process, we can visit all the neighboring vertices:</p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/vertexTraversal.png" alt="Walking around a vertex" height="382" width="327">
</center><p></p>

<p>In some sense, a halfedge mesh is kind of like a linked list on 
steroids. For instance, the halfedges around a given face (connected by <code>next</code> pointers) form a sort of "cyclic" linked list, where the tail points back to the head.</p>

<p>A nice consequence of the halfedge representation is that any valid halfedge mesh <strong>must</strong>
 be manifold and orientable.  Scotty3D will therefore only produce 
manifold, oriented meshes as output (and will complain if the input does
 not satisfy these criteria).</p>

<h3>The <code>HalfedgeMesh</code> Class</h3>

<p>The Scotty3D skeleton code already provides a fairly sophisticated implementation of the half edge data structure, in the <code>HalfedgeMesh</code> class (see <code>halfEdgeMesh.h</code> and <code>halfEdgeMesh.cpp</code>).
 Although the detailed implementation may appear a bit complicated, the 
basic interface is not much different from the abstract description 
given above. For instance, suppose we have a face f and want to print 
out the positions of all its vertices. We would write a routine like 
this:</p>

<pre class="prettyprint"><code><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">void</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> printVertexPositions</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">FaceCIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> f</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfEdgeCIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> f</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// get the first halfedge of the face</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">do</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">VertexCIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">   </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// get the vertex of the current halfedge</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    cout </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;&lt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">position </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;&lt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> endl</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">   </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// print the vertex position</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    h </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">                 </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// move to the next halfedge around the face</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">while</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">h </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">!=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> f</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">());</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">    </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// keep going until we're back at the beginning</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span></code></pre>

<p>Notice that we refer to a face as a <code>FaceCIter</code> rather than just a <code>Face</code>.  You can think of an <code>Iter</code> as a kind of <em>pointer</em>; the letter <code>C</code> indicates that this pointer is "constant", i.e., for this particular algorithm, we will not change the value pointed to by <code>f</code>.  Note that members of an iterator are accessed with an arrow <code>-&gt;</code> rather than a dot <code>.</code>,
 just as with pointers.  (A more in-depth explanation of some of these 
details can be found in the inline documentation.) Similarly, to print 
out the positions of all the neighbors of a given vertex we could write a
 routine like this:</p>

<pre class="prettyprint"><code><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">void</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> printNeighborPositions</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">VertexCIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfEdgeCIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">    </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// get one of the outgoing halfedges of the vertex</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">do</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfEdgeCIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h_twin </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// get the vertex of the current halfedge</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">VertexCIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h_twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// vertex is 'source' of the half edge.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
                                      </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// so h-&gt;vertex() is v,</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
                                      </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// whereas h_twin-&gt;vertex() is the neighbor vertex.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    cout </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;&lt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">position </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;&lt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> endl</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">      </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// print the vertex position</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    h </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h_twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">               </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// move to the next outgoing halfedge of the vertex.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">while</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">h </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">!=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">());</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">        </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// keep going until we're back at the beginning</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span></code></pre>

<p>To iterate over <strong>all</strong> the vertices in a halfedge mesh, we could write a loop like this:</p>

<pre class="prettyprint"><code><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">for</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">VertexCIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">verticesBegin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">!=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">verticesEnd</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">++)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  printNeighborPositions</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">v</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// do something interesting here</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span></code></pre>

<p>Internally, the lists of vertices, edges, faces, and halfedges are stored as <strong>linked lists</strong>, which allows us to easily add or delete elements to our mesh.  For instance, to add a new vertex we can write</p>

<pre class="prettyprint"><code><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">VertexIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">newVertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span></code></pre>

<p>Likewise, to delete a vertex we can write</p>

<pre class="prettyprint"><code><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">deleteVertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">v</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span></code></pre>

<p>Note, however, that one should be <strong>very, very careful</strong>
 when adding or deleting mesh elements. New mesh elements must be 
properly linked to the mesh -- for instance, this new vertex must be 
pointed to one of its associated halfedges by writing something like</p>

<pre class="prettyprint"><code><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">v</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span></code></pre>

<p>Likewise, if we delete a mesh element, we must be certain that no 
existing elements still point to it; the halfedge data structure does 
not take care of these relationships for you automatically. In fact, 
that is exactly the point of this assignment: to get some practice 
directly manipulating the halfedge data structure.  Being able to 
perform these low-level manipulations will enable you to write useful 
and interesting mesh code far beyond the basic operations in this 
assignment.</p>

<p>Finally, the <strong>boundary</strong> of the surface (e.g., the 
ankles and waist of a pair of pants) requires special care in our 
halfedge implementation. At first glance, it would seem that the routine
 <code>printNeighborPositions()</code> above might break if the vertex <code>v</code> is on the boundary, because at some point we worry that we have no <code>twin()</code>
 element to visit. Fortunately, our implementation has been designed to 
avoid this kind of catastrophe. In particular, rather than having an 
actual hole in the mesh, we create a "virtual" boundary face whose edges
 are all the edges of the boundary loop. This way, we can iterate over 
boundary elements just like any other mesh element. If we ever need to 
check whether an element is on the boundary, we have the methods.</p>

<pre class="prettyprint"><code><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Vertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">::</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">isBoundary</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Edge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">::</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">isBoundary</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Face</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">::</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">isBoundary</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">::</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">isBoundary</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span></code></pre>

<p>These methods return true if and only if the element is contained in 
the domain boundary. Additionally, we store an explicit list of boundary
 faces, which we can iterate over like any other type of mesh element:</p>

<pre class="prettyprint"><code><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">for</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">FaceCIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> b </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">boundariesBegin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> b </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">!=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">boundariesEnd</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> b</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">++)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// do something interesting with this boundary loop</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span></code></pre>

<p>These virtual faces are not stored in the usual face list, i.e., they
 will not show up when iterating over faces.  The figure below should 
help to further explain the behavior of <code>HalfedgeMesh</code> for surfaces with boundary:</p>

<p><img src="Assignment2_DeveloperManual_files/boundaryConventions.png" alt="Boundary conventions" height="375" width="396"></p>

<p>Dark blue regions indicate interior faces, whereas light blue regions
 indicate virtual boundary faces.  A vertex, edge, or halfedge is 
considered to be part of the boundary if it is contained <em>entirely</em>
 in a boundary face.  For instance, in the figure above the region b is a
 virtual boundary face, which means that vertex v', edge e', and 
halfedge h' are all part of the boundary; their <code>isBoundary()</code>
 methods will return true.  In contrast, vertex v, edge e, face f, and 
halfedge h are not part of the boundary, and their isBoundary() methods 
will return false.  Notice also that the boundary face b is a polygon 
with 12 edges.</p>

<p><em>Note:</em> <em>the edge degree and face degree of a boundary vertex is not the same!</em>  Notice, for instance, that vertex v' is contained in three edges but only two interior faces.  By convention, <code>Vertex::degree()</code>
 returns the face degree, not the edge degree.  The edge degree can be 
computed by finding the face degree, and adding 1 if the vertex is a 
boundary vertex.</p>

<p>Please refer to the inline comments for further details about the <code>HalfedgeMesh</code> data structure.</p>

<h3>Tutorial: Local Mesh Operations</h3>

<p>Many of the actions that need to be implemented in the MeshEdit mode 
are local mesh operations (like edge collapse, face bevel, etc.).  Here 
we provide a step-by-step guide to implementing a simplied version of 
the <em>EdgeFlip</em> operation for a pair of triangles---the final version, however, must be implemented for general polygons (i.e., any <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.59em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">n</script>-gon).  The basic strategy for implementing the other local operations is quite similar to the procedure outlined below.  <strong>Note:</strong> if you're not familiar with C++, you should definitely take a moment to learn about the <a href="http://en.cppreference.com/w/cpp/container/vector">standard library class</a> <code>std::vector</code>, especially the method <code>push_back()</code>, which will make it easy to accumulate a list of pointers as you walk around a polygon, vertex, etc.</p>

<p>A good recipe for ensuring that all pointers are still valid after a local remeshing operation is:</p>

<ol>
<li>Draw a picture of all the elements (vertices, edges, faces, 
halfedges) that will be needed from the original mesh, and all the 
elements that should appear in the modified mesh.</li>
<li>Allocate any new elements that are needed in the modified mesh, but do not appear in the original mesh.</li>
<li>For every element in the "modified" picture, set <strong>all</strong> of its pointers -- even if they didn't change. For instance, for each halfedge, make sure to set <code>next</code>, <code>twin</code>, <code>vertex</code>, <code>edge</code>, and <code>face</code> to the correct values in the new (modified) picture. For each vertex, make sure to set its <code>halfedge</code> pointer.  Etc. A convenience method <code>Halfedge::setNeighbors()</code> has been created for this purpose.</li>
<li>Deallocate any elements that are no longer used in the modified mesh, which can be done by calling <code>HalfedgeMesh::deleteVertex()</code>, <code>HalfedgeMesh::deleteEdge()</code>, etc.</li>
</ol>

<p>The reason for setting all the pointers (and not just the ones that 
changed) is that it is very easy to miss a pointer, causing your code to
 crash. Once the code is working, you can remove these unnecessary 
assignments if you wish -- but remember that <a href="http://c2.com/cgi/wiki?PrematureOptimization">premature optimization is the root of all evil</a></p>

<p>We now consider the case of a triangle-triangle edge flip.</p>

<h4>PHASE 0: Draw a Diagram</h4>

<p>Suppose we have a pair of triangles (a,b,c) and (c,b,d). After 
flipping the edge (b,c), we should now have triangles (a,d,c) and 
(a,b,d).  A good first step for implementing any local mesh operation is
 to draw a diagram that clearly labels all elements affected by the 
operation:</p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/edgeFlipBeforeAfter.png" alt="Edge flip before and after" height="225" width="673">
</center><p></p>

<p>Here we have drawn a diagram of the region around the edge both 
before and after the edge operation (in this case, "flip"), labeling 
each type of element (halfedge, vertex, edge, and face) from zero to the
 number of elements.  It is important to include every element affected 
by the operation, thinking very carefully about which elements will be 
affected.  If elements are omitted during this phase, everything will 
break---even if the code written in the two phases is correct!  In this 
example, for instance, we need to remember to include the halfedges 
"outside" the neighborhood, since their "twin" pointers will be 
affected.</p>

<h4>PHASE I: Collect elements</h4>

<p>Once you've drawn your diagram, simply collect all the elements from 
the "before" picture. Give them the same names as in your diagram, so 
that you can debug your code by comparing with the picture.</p>

<pre class="prettyprint"><code><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// HALFEDGES</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h0 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h1 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h2 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h3 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h4 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h3</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h5 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h4</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h6 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h7 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h2</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h8 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h4</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h9 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h5</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// VERTICES</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">VertexIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v0 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">VertexIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v1 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h3</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// ...you fill in the rest!...</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// EDGES</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
e1 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">edge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
e2 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h2</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">edge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// ...you fill in the rest!...</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// FACES</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
f0 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">face</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// ...you fill in the rest!...</span></span></span></span></span></code></pre>

<h4>PHASE II: Allocate new elements</h4>

<p>If your edge operation requires new elements, now is the time to 
allocate them. For the edge flip, we don't need any new elements; but 
suppose that for some reason we needed a new vertex v4. At this point we
 would allocate the new vertex via</p>

<pre class="prettyprint"><code><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">VertexIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v4 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">newVertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span></code></pre>

<p>(The name used for this new vertex should correspond to the label you
 give it in your "after" picture.)  Likewise, new edges, halfedges, and 
faces can be allocated via the methods <code>mesh.newEdge()</code>, <code>mesh.newHalfedge()</code>, and <code>mesh.newFace()</code>.</p>

<h4>PHASE III: Reassign Elements</h4>

<p>Next, update the pointers for all the mesh elements that are affected
 by the edge operation. Be exhaustive! In other words, go ahead and 
specify every pointer for every element, even if it did not change. Once
 things are working correctly, you can always optimize by removing 
unnecessary assignments. But get it working correctly first! Correctness
 is more important than efficiency.</p>

<pre class="prettyprint"><code><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// HALFEDGES</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h3</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v3</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">edge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">face</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> f0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h2</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h7</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v2</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">edge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e2</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">face</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> f0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// ...you fill in the rest!...</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// ...and don't forget about the "outside" elements!...</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h9</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h9</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">next</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// didn't change, but set it anyway!</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h9</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">twin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h4</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h9</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h9</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">edge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e4</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
h9</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">face</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h9</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">face</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// didn't change, but set it anyway!</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// VERTICES</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
v0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h2</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
v1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h5</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
v2</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h3</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
v3</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// EDGES</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
e0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">//...you fill in the rest!...</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// FACES</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
f0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">halfedge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> h0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">//...you fill in the rest!...</span></span></span></span></span></code></pre>

<h4>PHASE IV: Delete unused elements</h4>

<p>If your edge operation eliminates elements, now is the best time to 
deallocate them: at this point, you can be sure that they are no longer 
needed. For instance, since we do not need the vertex allocated in PHASE
 II, we could write</p>

<pre class="prettyprint"><code><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">deleteVertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> v4 </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span></code></pre>

<p>You should be careful that this mesh element is not referenced by any
 other element in the mesh. But if your "before" and "after" diagrams 
are correct, that should not be an issue!</p>

<h4>Design considerations</h4>

<p>The basic algorithm outlined above will handle most edge flips, but 
you should also think carefully about possible corner-cases.  You should
 also think about other design issues, like "how much should this 
operation cost?"  For instance, for this simple triangle-triangle edge 
flip it might be reasonable to:</p>

<ul>
<li>Ignore requests to flip boundary edges (i.e., just return immediately if either neighboring face is a boundary loop).</li>
<li>Ignore requests to perform any edge flip that would make the surface non-manifold or otherwise invalidate the mesh.</li>
<li>Not add or delete any elements.  Since there are the same number of 
mesh elements before and after the flip, you should only need to 
reassign pointers.</li>
<li>Perform only a constant amount of work -- the cost of flipping a single edge should <strong>not</strong> be proportional to the size of the mesh!</li>
</ul>

<p>Formally proving that your code is correct in all cases is 
challenging, but at least try to think about what could go wrong in 
degenerate cases (e.g., vertices of low degree, or very small meshes 
like a tetrahedron). The biggest challenge in properly implementing this
 type of local operation is making sure that all the pointers still 
point to the right place in the modified mesh, and will likely be the 
cause of most of your crashes!</p>

<h4>Beveling</h4>

<p>Here we provide some additional detail about the bevel operations and
 their implementation in Scotty3D.  Each bevel operation has two 
components:</p>

<ol>
<li>a method that modifies the <em>connectivity</em> of the mesh, creating new beveled elements, and</li>
<li>a method the updates the <em>geometry</em> of the mesh, insetting and offseting the new vertices according to user input.</li>
</ol>

<p>The methods that update the connectivity are <code>HalfedgeMesh::bevelVertex</code>, <code>halfedgeMesh::bevelEdge</code>, and <code>HalfedgeMesh::bevelFace</code>.  The methods that update geometry are <code>HalfedgeMesh::_bevel_vtx_reposition_with_dist</code>, <code>HalfedgeMesh::_bevel_edge_reposition_with_dist</code>, and <code>HalfedgeMesh::_bevel_fc_reposition_with_dist</code>.  The methods for updating connectivity can be implemented following the general strategy outlined in the tutorial above.</p>

<p>To update the <em>geometry</em> of a beveled element, you are provided with the following data:</p>

<ul>
<li><code>orig</code> - These are the original vertex positions of the mesh element, before any insetting or offseting is applied.</li>
<li><code>hs</code> - These are the halfedges "around" the element currently being beveled.</li>
<li><code>inset</code> - The amount by which the new face should be inset (i.e., "shrunk" or "expanded")</li>
<li><code>shift</code> (faces only) - The amount by which the new face should be offset in the normal direction.</li>
</ul>

<p>More specifically, the array <code>hs</code> stores the following data:</p>

<ul>
<li>For a beveled vertex, <code>hs</code> stores the halfedges pointing <em>from</em> the vertices of the new polygon <em>to</em> the neighbors of the original vertex.</li>
<li>For a beveled edge, <code>hs</code> stores the halfedges pointing <em>from</em> the vertices of the new polygon <em>to</em> the neighbors of the original edge endpoints.</li>
<li>For a beveled face, <code>hs</code> stores the halfedges pointing <em>from</em> the vertices of the new polygon <em>to</em> the vertices of the original polygon.</li>
</ul>

<p>These relationships are illustrated by the following diagram:</p>

<p><img src="Assignment2_DeveloperManual_files/Scotty3DBeveledData.svg" alt="BeveledData"></p>

<p>The basic recipe for updating the vertex positions is then:</p>

<ul>
<li>Iterate over the list of halfedges (<code>hs</code>)</li>
<li>Grab the vertex coordinates that are needed to compute the new, updated vertex coordinates (this could be a mix of values from <code>orig</code>, or the members <code>Vertex::position</code>)</li>
<li>Compute the updated vertex positions using the current values of <code>inset</code> (and possibly <code>shift</code>)</li>
<li>Store the new vertex positions in <code>Vertex::position</code> <em>for the vertices of the new, beveled polygon only</em> (i.e., the positions of any polygon "outside" the dark blue one in the figures above should not be updated)</li>
</ul>

<p>The reason for storing <code>hs</code> and <code>orig</code> in an 
array is that it makes it easy to access positions "to the left" and "to
 the right" of a given vertex.  For instance, suppose we want to figure 
out the offset from the corner of a polygon.  We might want to compute 
some geometric quantity involving the three vertex positions <code>orig[i-1]</code>, <code>orig[i]</code>, and <code>orig[i+1]</code> (as well as <code>inset</code>), then set the new vertex position <code>hs[i]-&gt;vertex()-&gt;position</code> to this new value:</p>

<p><img src="Assignment2_DeveloperManual_files/Scotty3DBevelIndexing.svg" alt="BevelIndexing"></p>

<p>A useful trick here is <em>modular arithmetic</em>: since we really 
have a "loop" of vertices, we want to make sure that indexing the next 
element (+1) and the previous element (-1) properly "wraps around."  
This can be achieved via code like</p>

<pre class="prettyprint"><code><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// Get the number of vertices in the new polygon</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">int</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> N </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> hs</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">size</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// Assuming we're looking at vertex i, compute the indices</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// of the next and previous elements in the list using</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// modular arithmetic---note that to get the previous index,</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// we can't just subtract 1 because the mod operation in C++</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// doesn't behave quite how you might expect for negative</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// values!</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">int</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> a </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">i</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">+</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">N</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">-</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">%</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> N</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">int</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> b </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> i</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">int</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> c </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">i</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">+</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">%</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> N</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// Get the actual 3D vertex coordinates at these vertices</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Vector3D</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> pa </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> orig</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">[</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">a</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">];</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Vector3D</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> pb </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> orig</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">[</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">b</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">];</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Vector3D</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> pc </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> orig</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">[</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">c</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">];</span></span></span></span></span></code></pre>

<p>From here, you will need to compute new coordinates for vertex <code>i</code>, which can be accessed from <code>hes[i]-&gt;vertex()-&gt;position</code>.
  As a "dummy" example (i.e., this is NOT what you should actually do!!)
 this code will set the position of the new vertex to the average of the
 vertices above:</p>

<pre class="prettyprint"><code><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">hes</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">[</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">i</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">].</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vertex</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()-&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">position </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> pa </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">+</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> pb </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">+</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> pc </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">/</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">3.</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// replace with something that actually makes sense!</span></span></span></span></span></code></pre>

<p>The only question remaining is: where <em>should</em> you put the beveled vertex? <strong>We will leave this decision up to you.</strong>  This question is one where you will have to think a little bit about what a good design would be.  Questions to ask yourself:</p>

<ul>
<li>How do I compute a point that is inset from the original geometry?</li>
<li>For faces, how do I shift the geometry in the normal direction? (You may wish to use the method <code>Face::normal()</code> here.)</li>
<li>What should I do as the offset geometry starts to look degenerate, 
e.g., shrinks to a point, or goes outside some reasonable bounds?</li>
<li>What should I do when the geometry is nonplanar?</li>
<li>Etc.</li>
</ul>

<p>The best way to get a feel for whether you have a good design is <em>to try it out!</em>
  Can you successfully and easily use this tool to edit your mesh?  Or 
is it a total pain, producing bizarre results?  You be the judge!</p>

<h4>Interface with global mesh operations</h4>

<p>To facilitate user interaction, as well as global mesh processing 
operations (described below), local mesh operations should return the 
following values when possible.  If the specified values are not 
available, you should think about a reasonable alternative value to 
return.  First and foremost, <em>the program should not crash!</em>  So 
for instance, you should not return a pointer to an element that was 
deleted.  Second, you should try as much as possible to return a value 
related to the argument.  For instance, if the user asks to flip an edge
 <code>e</code> that cannot be flipped (e.g., a boundary edge), the most natural solution would be to simply return <code>e</code>.  Likewise, if the user asks to erase an edge <code>e</code> that cannot be erased, a natural return value might be an adjacent (non-boundary) face.  Etc.</p>

<ul>
<li><code>HalfedgeMesh::flipEdge</code> - should return the edge that was flipped</li>
<li><code>HalfedgeMesh::splitEdge</code> - should return the inserted vertex</li>
<li><code>HalfedgeMesh::collapseEdge</code> - should return the new vertex, corresponding to the collapsed edge</li>
<li><code>HalfedgeMesh::collapseFace</code> - should return the new vertex, corresponding to the collapsed face</li>
<li><code>HalfedgeMesh::eraseVertex</code> - should return the new face, corresponding to the faces originally containing the vertex</li>
<li><code>HalfedgeMesh::eraseEdge</code> - should return the new face, corresponding to the faces originally containing the edge</li>
<li><code>HalfedgeMesh::bevelVertex</code> - should return the new face, corresponding to the beveled vertex</li>
<li><code>HalfedgeMesh::bevelEdge</code> - should return the new face, corresponding to the beveled edge</li>
<li><code>HalfedgeMesh::bevelFace</code> - should return the new, inset face</li>
</ul>

<hr>

<h2>Global Mesh Processing</h2>

<p>In addition to local operations on mesh connectivity, Scotty3D 
provides several global remeshing operations (as outlined in the User 
Guide).  Two different mechanisms are used to implement global 
operations:</p>

<ul>
<li><em>Repeated application of local operations.</em> Some mesh 
operations are most easily expressed by applying local operations (edge 
flips, etc.) to a sequence of mesh elements until the target output is 
achieved.  A good example is mesh simplification, which is a greedy 
algorithm that collapses one edge at a time (see further discussion 
below).</li>
<li><em>Global replacement of the mesh.</em> Other mesh operations are 
better expressed by temporarily storing new mesh elements in a simpler 
mesh data structure (e.g., an indexed list of faces) and completely 
re-building the halfedge data structure from this data.  A good example 
is Catmull-Clark subdivision, where every polygon must be simultaneously
 split into quadrilaterals (see further discussion below).</li>
</ul>

<p>Note that in general there are no inter-dependencies among global 
remeshing operations (except that some of them require a triangle mesh 
as input, which can be achieved via the method <code>HalfedgeMesh::triangulate</code>).</p>

<p>As a sanity check, each of your resampling algorithms should complete
 almost instantaneously (no more than a second or so) on meshes of a few
 hundred polygons. If performance is significantly worse than this, you 
may be repeatedly iterating over more elements than you really need to, 
or allocating/deallocating more memory than necessary.  A useful 
debugging technique is to print out (or otherwise keep track of, e.g., 
via an integer counter or a profiler) the number of times basic methods 
like <code>Halfedge::next()</code> or <code>HalfedgeMesh::newVertex()</code>
 are called during a single execution of one of your methods; for most 
methods this number should be some reasonably small constant (no more 
than, say, 1000!) times the number of elements in the mesh.</p>

<hr>

<h3>Triangulation</h3>

<p>A variety of geometry processing algorithms become easier to 
implement (or are only well defined) when the input consists purely of 
triangles.  The method <code>HalfedgeMesh::triangulate</code> converts 
any polygon mesh into a triangle mesh by splitting each polygon into 
triangles.  This transformation is performed in-place, i.e., the 
original mesh data is replaced with the new, triangulated data (rather 
than making a copy).  The <code>triangulate</code> method is basically just a wrapper around <code>HalfedgeMesh::splitPolygon</code>, which splits a single face <code>f</code>
 into triangles.  The implementation of this method will look much like 
the implementation of the local mesh operations (see the tutorial 
above).</p>

<p>There is more than one way to split a polygon into triangles.  Two 
common patterns are to connect every vertex to a single vertex, or to 
"zig-zag" the triangulation across the polygon:</p>

<p><img src="Assignment2_DeveloperManual_files/Scotty3DTriangulate.svg" alt="Scotty3DTriangulate"></p>

<p>The <code>splitPolygon</code> routine is not required to produce any particular triangulation so long as:</p>

<ul>
<li>all polygons in the output are triangles,</li>
<li>the vertex positions remain unchanged, and</li>
<li>the output is a valid, manifold halfedge mesh.</li>
</ul>

<p>Note that triangulation of nonconvex or nonplanar polygons may lead 
to geometry that is unattractive or difficult to interpret.  However, 
the purpose of this method is simply to produce triangular <em>connectivity</em>
 for a given polygon mesh, and correct halfedge connectivity is the only
 invariant that must be preserved by the implementation.  The <em>geometric</em>
 quality of the triangulation can later be improved by running other 
global algorithms (e.g., isotropic remeshing); ambitious developers may 
also wish to consult the following reference:</p>

<ul>
<li>Zou et al, <a href="http://www.cs.wustl.edu/%7Etaoju/research/triangulate_final.pdf">"An Algorithm for Triangulating Multiple 3D Polygons"</a></li>
</ul>

<hr>

<h3>Subdivision</h3>

<p>In image processing, we often have a low resolution image that we 
want to display at a higher resolution. Since we only have a few samples
 of the original signal, we need to somehow interpolate or <em>upsample</em>
 the image. One idea would be to simply cut each pixel into four, 
leaving the color values unchanged, but this leads to a blocky 
appearance. Instead we might try a more sophisticated scheme (like 
bilinear or trilinear interpolation) that yields a smoother appearance.</p>

<p>In geometry processing, one encounters the same situation: we may 
have a low-resolution polygon mesh that we wish to upsample for display,
 simulation, etc.  Simply splitting each polygon into smaller pieces 
doesn't help, because it does nothing to alleviate blocky silhouettes or
 chunky features. Instead, we need an upsampling scheme that nicely 
interpolates or approximates the original data. Polygon meshes are quite
 a bit trickier than images, however, since our sample points are 
generally at <em>irregular</em> locations, i.e., they are no longer found at regular intervals on a grid.</p>

<p>Three subdivision schemes are supported by Scotty3D: Linear, 
Catmull-Clark, and Loop.  The first two can be used on any polygon mesh,
 and should be implemented via the global replacement strategy described
 above.  Loop subdivision can be implemented using repeated application 
of local oeprations.  See further details below.</p>

<h4>Linear subdivision</h4>

<p>Although our ultimate goal is to produce a smooth approximation of 
the control cage, the first step is to simply update the connectivity 
(but not the vertex positions) so that the mesh has a larger number of 
elements.  This kind of basic splitting or "linear subdivision" is also 
useful for box modeling, when we simply want to increase the number of 
available control points.</p>

<p>Unlike most of the other global remeshing operations, linear (and 
Catmull-Clark) subdivision will proceed by completely replacing the 
original halfedge mesh with a new one.  The high-level procedure is:</p>

<ol>
<li>Generate a list of vertex positions for the new mesh.</li>
<li>Generate a list of polygons for the new mesh, as a list of indices into the new vertex list (a la "polygon soup").</li>
<li>Hand these two lists to the method <code>HalfedgeMesh::rebuild</code>, which rebuilds the halfedge connectivity from scratch.</li>
</ol>

<p>Given these lists, <code>rebuild</code> will take care of allocating halfedges, setting up <code>next</code> and <code>twin</code>
 pointers, etc., based on the list of polygons generated in step 
2---this routine is already implemented in the Scotty3D skeleton code.</p>

<p>Both linear and Catmull-Clark subdivision schemes will handle general <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.59em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">n</script>-gons (i.e., polygons with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 0.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.59em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">n</script> sides) rather than, say, quads only or triangles only.  Each <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 0.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.59em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">n</script>-gon (including but not limited to quadrilaterals) will be split into <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 0.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.59em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">n</script> quadrailaterals according to the following template:</p>

<p><img src="Assignment2_DeveloperManual_files/Scotty3DQuadSubdivide.svg" alt="Scotty3DQuadSubdivide"></p>

<p>The high-level procedure is outlined in greater detail in <code>HalfedgeMesh::subdivideQuad</code>.</p>

<h5>Vertex positions</h5>

<p>For global linear or Catmull-Clark subdivision, the strategy for 
assigning new vertex positions may at first appear a bit strange: in 
addition to updating positions at vertices, we will also calculate 
vertex positions associated with the <em>edges</em> and <em>faces</em> 
of the original mesh.  Storing new vertex positions on edges and faces 
will make it extremely convenient to generate the polygons in our new 
mesh, since we can still use the halfedge data structure to decide which
 four positions get connected up to form a quadrilateral.  In 
particular, each quad in the new mesh will consist of:</p>

<ul>
<li>one new vertex associated with a face from the original mesh,</li>
<li>two new vertices associated with edges from the original mesh, and</li>
<li>one vertex from the original mesh.</li>
</ul>

<p>For linear subdivision, the rules for computing new vertex positions are very simple:</p>

<ul>
<li>New vertices at original faces are assigned the average coordinates of all corners of that face (i.e., the arithmetic mean).</li>
<li>New vertices at original edges are assigned the average coordinates of the two edge endpoints.</li>
<li>New vertices at original vertices are assigned the same coordinates as in the original mesh.</li>
</ul>

<p>These values should be assigned to the members <code>Face::newPosition</code>, <code>Edge::newPosition</code>, and <code>Vertex::newPosition</code>, respectively.  For instance, <code>f-&gt;newPosition = Vector3D( x, y, z );</code> will assign the coordinates (x,y,z) to the new vertex associated with face <code>f</code>.
  The general strategy for assigning these new positions is to iterate 
over all vertices, then all edges, then all faces, assigning appropriate
 values to <code>newPosition</code>.  <strong>Note:</strong> you <em>must</em> copy the original vertex position <code>Vertex::position</code> to the new vertex position <code>Vertex::newPosition</code>; these values will not be used automatically.</p>

<p>This step should be implemented in the method <code>HalfedgeMesh::computeLinearSubdivisionPositions</code> in <code>meshEdit.cpp</code>.</p>

<p>Once the new vertex positions have been assigned to elements of the 
halfedge mesh, they need to be accumulated into a single list of <em>all</em> vertex positions in the new mesh, which will be handed to <code>HalfedgeMesh::rebuild</code>.  It is important that <em>vertex coordinates in this list appear in the same order they were indexed!</em>
  For instance, if you index vertices, then edges, then faces, then the 
final vertex coordinate list should likewise contain coordinates from 
vertices, then coordinates from edges, then coordinates from faces.  
These vertex coordinates can be accumuluated using an object of type <code>vector&lt;Vector3D&gt;</code>,
 i.e., a dynamically-sized array of vertex positions.  The basic 
strategy is to loop over all vertices, then all edges, then all faces, 
calling <code>push_back</code> to append each new vertex coordinate to the list.  (See the next section for further discussion of the <code>vector</code> class.)  Further details are provided in the in-line comments.</p>

<p>This last step should be implemented in the method <code>HalfedgeMesh::buildSubdivisionVertexList</code> in <code>meshEdit.cpp</code>.</p>

<h5>Vertex indices</h5>

<p>In addition to new (x,y,z) coordinates, we also need to assign a unique <em>index</em>
 to each vertex in the new mesh---including those that are associated 
with edges and faces.  In other words, every vertex, edge, and face in 
the mesh will be assigned an integer between 0 and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 3.247em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.584em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1002.51em, 2.666em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mn" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.17em; border-left: 0px solid; width: 0px; height: 1.085em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>&#8722;</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">N-1</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-21" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.88em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.88em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-22"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">N</script> is the total number of vertices <em>plus</em> edges <em>plus</em> faces in the original mesh.  A simple strategy for assigning these indices is:</p>

<ol>
<li>Initialize a counter to zero.</li>
<li>Iterate over vertices, assigning the index of the current vertex to the counter value, and incrementing the counter.</li>
<li>Iterate over edges, assigning the index of the current edge to the counter value, and incrementing the counter.</li>
<li>Iterate over faces, assigning the index of the current face to the counter value, and incrementing the counter.</li>
</ol>

<p>Note that the particular choice of indices does not matter---the only
 things you must guarantee are that (i) every mesh element is assigned a
 valid index, and (ii) no two mesh elements share the same index.</p>

<h5>Polygons</h5>

<p>Unlike the local operations described above, which are applied one 
element after another, in linear and Catmull-Clark subdivision <em>all polygons are subdivided simultaneously</em>.  In other words, if we focus on the whole mesh (rather than a single polygon), then we are</p>

<ul>
<li>creating one new vertex for each edge,</li>
<li>creating one new vertex for each face, and</li>
<li>keeping all the vertices of the original mesh.</li>
</ul>

<p>These vertices are then connected up to form quadrilaterals (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-24" style="width: 0.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.59em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-25"><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">n</script> quadrilaterals for each <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-27" style="width: 0.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.59em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">n</script>-gon).
  Rather than directly modifying the halfedge connectivity, new quads 
will be collected in a much simpler mesh data structure: a list of 
polygons.  Note that with this subdivision scheme, <em>every</em> polygon in the output mesh will be a quadrilateral, even if the input contains triangles, pentagons, etc.</p>

<p>In Scotty3D, a list of polygons can be declared as</p>

<pre class="prettyprint"><code><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vector</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> vector</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Index</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> quads</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span></code></pre>

<p>where <code>vector</code> is a <a href="http://en.cppreference.com/w/cpp/container/vector">class from the C++ standard template library</a>, representing a dynamically-sized array.  An <code>Index</code> is just another name for a <code>size_t</code>,
 which is the standard C++ type for integers that specify an element of 
an array.  Polygons can be created by allocating a list of appropriate 
size, then specifying the indices of each vertex in the polygon.  For 
example:</p>

<pre class="prettyprint"><code><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vector</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Index</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> quad</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">4</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// allocate an array with four elements</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// Build a quad with vertices specified by integers (a,b,c,d), starting at zero.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// These indices should correspond to the indices computing when assigning vertex</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// positions, as described above.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
quad</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">[</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">]</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> a</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
quad</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">[</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">1</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">]</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> b</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
quad</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">[</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">2</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">]</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> c</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
quad</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">[</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">3</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">]</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> d</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span></code></pre>

<p>Once a quad has been created, it can be added to the list of quads by using the method <code>vector::push_back</code>, which appends an item to a vector:</p>

<pre class="prettyprint"><code><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">vector</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> vector</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Index</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&gt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> newPolygons</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
newPolygons</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">push_back</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> quad </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span></code></pre>

<p>The full array of new polygons will then be passed to the method <code>HalfedgeMesh::rebuild</code>, together with the new vertex positions.</p>

<p>This step should be implemented in the method <code>HalfedgeMesh::buildSubdivisionFaceList</code> in <code>meshEdit.cpp</code>.</p>

<h4>Catmull-Clark subdivision</h4>

<p>The only difference between Catmull-Clark and linear subdivision is 
the choice of positions for new vertices.  Whereas linear subdivision 
simply takes a uniform average of the old vertex positions, 
Catmull-Clark uses a very carefully-designed <em>weighted</em> average 
to ensure that the surface converges to a nice, round surface as the 
number of subdivision steps increases.  The original scheme is described
 in the paper <em>``Recursively generated B-spline surfaces on arbitrary topological meshes''</em>
 by (Pixar co-founder) Ed Catmull and James Clark.  Since then, the 
scheme has been thoroughly discussed, extended, and analyzed; more 
modern descriptions of the algorithm may be easier to read, including 
those from the <a href="https://en.wikipedia.org/wiki/Catmull_Clark_subdivision_surface">Wikipedia</a> and <a href="http://www.rorydriscoll.com/2008/08/01/catmull-clark-subdivision-the-basics/">this webpage</a>.  In short, the new vertex positions can be calculated by:</p>

<ol>
<li>setting the new vertex position at each face f to the average of all its original vertices (exactly as in linear subdivision),</li>
<li>setting the new vertex position at each edge e to the average of the
 new face positions (from step 1) and the original endpoint positions, 
and</li>
<li>setting the new vertex position at each vertex v to the weighted sum</li>
</ol>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-30" style="width: 11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.853em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(0.777em, 1008.78em, 3.281em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-31"><span class="mfrac" id="MathJax-Span-32"><span style="display: inline-block; position: relative; width: 8.359em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.099em, 1008.24em, 4.429em, -1000em); top: -4.741em; left: 50%; margin-left: -4.12em;"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mn" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math; font-style: italic;">R</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mn" id="MathJax-Span-42" style="font-family: MathJax_Main; padding-left: 0.222em;">3</span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-44" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(3.407em, 1000.58em, 4.19em, -1000em); top: -3.328em; left: 50%; margin-left: -0.3em;"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(0.811em, 1008.36em, 1.21em, -1000em); top: -1.265em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 8.359em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.045em;"></span></span></span></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.932em; border-left: 0px solid; width: 0px; height: 2.833em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mi>Q</mi><mo>+</mo><mn>2</mn><mi>R</mi><mo>+</mo><mo stretchy="false">(</mo><mi>n</mi><mo>&#8722;</mo><mn>3</mn><mo stretchy="false">)</mo><mi>S</mi></mrow><mi>n</mi></mfrac><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-10"> \frac{Q + 2R + (n-3)S}{n}, </script><p></p>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-47" style="width: 0.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.59em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-48"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">n</script> is the degree of vertex <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-50" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.811em, 1000.48em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.699em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">v</script> (i.e., the number of faces containing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.811em, 1000.48em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.699em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">v</script>), and</p>

<ul>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-56" style="width: 0.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.77em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.55em, 1000.72em, 2.778em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.25em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">Q</script> is the average of all new face position for faces containing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-59" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.811em, 1000.48em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.699em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">v</script>,</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-62" style="width: 0.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.77em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.77em, 2.605em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math; font-style: italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">R</script> is the average of all new edge positions for edges containing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.811em, 1000.48em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-66"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.699em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">v</script>, and</li>
<li><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-68" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.66em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.549em, 1000.66em, 2.606em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-69"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math; font-style: italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.032em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.038em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">S</script> is the original vertex position for vertex <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.811em, 1000.48em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.699em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">v</script>.</li>
</ul>

<p>In other words, the new vertex positions are an "average of averages."  (Note that you <em>will</em> need to divide by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-74" style="width: 0.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.605em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.59em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-75"><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">n</script> <em>both</em> when computing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-77" style="width: 0.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.77em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.55em, 1000.72em, 2.778em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math; font-style: italic;">Q</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.25em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">Q</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-80" style="width: 0.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.77em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.77em, 2.605em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic;">R</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.094em; border-left: 0px solid; width: 0px; height: 1.009em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">R</script>, <em>and</em> when computing the final, weighted value---this is not a typo!)</p>

<p>Apart from changing the way vertex positions are computed, there 
should be no difference in your implementation of linear and 
Catmull-Clark subdivision.</p>

<p>This step should be implemented in the method <code>HalfedgeMesh::computeCatmullClarkPositions</code> in <code>meshEdit.cpp</code>.</p>

<h4>Loop subdivision</h4>

<p>Loop subdivision (named after <a href="http://research.microsoft.com/en-us/um/people/cloop/">Charles Loop</a>) is a standard approximating subdivision scheme for triangle meshes. At a high level, it consists of two basic steps:</p>

<ol>
<li>Split each triangle into four by connecting edge midpoints (sometimes called "4-1 subdivision").</li>
<li>Update vertex positions as a particular weighted average of neighboring positions.</li>
</ol>

<p>The 4-1 subdivision looks like this:</p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/41Subdivision.png" alt="4-1 Subdivision" height="157" width="500">
</center><p></p>

<p>And the following picture illustrates the weighted average:</p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/LoopWeights.png" alt="Loop subdivision weights" height="157" width="500">
</center><p></p>

<p>In words, the new position of an old vertice is (1 - nu) times the 
old position + u times the sum of the positions of all of its neighbors.
 The new position for a newly created vertex v that splits Edge AB and 
is flanked by opposite vertices C and D across the two faces connected 
to AB in the original mesh will be 3/8 * (A + B) + 1/8 * (C + D).  If we
 repeatedly apply these two steps, we will converge to a fairly smooth 
approximation of our original mesh.</p>

<p>In contrast to linear and Catmull-Clark subdivision, Loop subdivision
 should be implemented using the local mesh operations described above 
(simply because it provides an alternative perspective on subdivision 
implementation, which can be useful in different scenarios).  In 
particular, 4-1 subdivision can be achieved by applying the following 
strategy:</p>

<ol>
<li>Split every edge of the mesh <em>in any order whatsoever</em>.</li>
<li>Flip any new edge that touches a new vertex and an old vertex.</li>
</ol>

<p>The following pictures (courtesy Denis Zorin) illustrate this idea:</p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/FlippingSubdivision.png" alt="Subdivision via flipping" height="225" width="500">
</center><p></p>

<p>Notice that only blue (and not black) edges are flipped in this 
procedure; as described above, edges in the split mesh should be flipped
 if and only if they touch both an original vertex <em>and</em> a new vertex (i.e., a midpoint of an original edge).</p>

<p>When working with dynamic mesh data structures (like a halfedge mesh), one must think <strong>very carefully</strong>
 about the order in which mesh elements are processed---it is quite easy
 to delete an element at one point in the code, then try to access it 
later (typically resulting in a crash!). For instance, suppose we write a
 loop like this:</p>

<pre class="prettyprint"><code><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// iterate over all edges in the mesh</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">for</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">edgesBegin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">!=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">edgesEnd</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">++)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">if</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">some condition </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">is</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> met</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">splitEdge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">e</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span></code></pre>

<p>Although this routine looks straightforward, it can very easily 
crash!  The reason is fairly subtle: we are iterating over edges in the 
mesh by incrementing the iterator <code>e</code> (via the expression <code>e++</code>). But since <code>splitEdge()</code> is allowed to create and delete mesh elements, it might deallocate the edge pointed to by <code>e</code> before we increment it!  To be safe, one should instead write a loop like this:</p>

<pre class="prettyprint"><code><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// iterate over all edges in the mesh</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">int</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> n </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">nEdges</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">edgesBegin</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">for</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">int</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> i </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">0</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> i </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&lt;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> n</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> i</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">++)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

  </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// get the next edge NOW!</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> nextEdge </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  nextEdge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">++;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

  </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// now, even if splitting the edge deletes it...</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">if</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">some condition </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">is</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> met</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    mesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">splitEdge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">e</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

  </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// ...we still have a valid reference to the next edge.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  e </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> nextEdge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">}</span></span></span></span></span></code></pre>

<p>Note that this loop is just <em>one example</em> -- in general, you 
should think about which elements might be affected by a local mesh 
operation when writing your loops. Likewise, you can make life easier on
 yourself by making sure that your atomic edge operations provide 
certain guarantees. For instance, if your implementation of <code>HalfedgeMesh::flipEdge()</code>
 guarantees that no edges will be created or destroyed (as it should), 
then you can safely do edge flips inside a loop without worrying about 
these kinds of side effects.</p>

<p>For Loop subdivision, there are some additional data members that 
will make it easy to keep track of the data needed to update the 
connectivity and vertex positions. In particular:</p>

<ul>
<li><code>Vertex::newPosition</code> can be used as temporary storage for the new position (computed via the weighted average above).  Note that you should <em>not</em> change the value of <code>Vertex::position</code> until <em>all</em> the new vertex positions have been computed -- otherwise, you are taking averages of values that have already been averaged!</li>
<li>Likewise, <code>Edge::newPosition</code> can be used to store the 
position of the vertices that will ultimately be inserted at edge 
midpoints.  Again, these values should be computed from the original 
values (before subdivision), and applied to the new vertices only at the
 very end. The <code>Edge::newPosition</code>value will be used for the 
position of the vertex that will appear along the old edge after the 
edge is split. We precompute the position of the new vertex before 
splitting the edges and allocating the new vertices because it is easier
 to tansverse the simpler original mesh to find the positions for the 
weighted average that determines the positions of the new vertices.</li>
<li><code>Vertex::isNew</code> can be used to flag whether a vertex was 
part of the original mesh, or is a vertex newly inserted by subdivision 
(at an edge midpoint).</li>
<li><code>Edge::isNew</code> likewise flags whether an edge is a piece 
of an edge in the original mesh, or is an entirely new edge created 
during the subdivision step.</li>
</ul>

<p>Given this setup, we strongly suggest that it will be easiest to 
implement subdivision according to the following "recipe" (though you 
are of course welcome to try doing things a different way!). The basic 
strategy is to <em>first</em> compute the new vertex positions (storing the results in the <code>newPosition</code> members of both vertices and edges), and only <em>then</em>
 update the connectivity. Doing it this way will be much easier, since 
traversal of the original (coarse) connectivity is much simpler than 
traversing the new (fine) connectivity. In more detail:</p>

<ol>
<li>Mark all vertices as belonging to the original mesh by setting <code>Vertex::isNew</code> to <code>false</code> for all vertices in the mesh.</li>
<li>Compute updated positions for all vertices in the original mesh using the vertex subdivision rule, and store them in <code>Vertex::newPosition</code>.</li>
<li>Compute new positions associated with the vertices that will be inserted at edge midpoints, and store them in <code>Edge::newPosition</code>.</li>
<li>Split every edge in the mesh, being careful about how the loop is 
written.  In particular, you should make sure to iterate only over edges
 of the original mesh.  Otherwise, you will keep splitting edges that 
you just created!</li>
<li>Flip any new edge that connects an old and new vertex.</li>
<li>Finally, copy the new vertex positions (<code>Vertex::newPosition</code>) into the usual vertex positions (<code>Vertex::position</code>).</li>
</ol>

<p>If you made the requested modification to the return value of <code>HalfedgeMesh::splitEdge()</code>
 (see above), then an edge split will now return an iterator to the 
newly inserted vertex, and the halfedge of this vertex will point along 
the edge of the original mesh. This iterator is useful because it can be
 used to (i) flag the vertex returned by the split operation as a new 
vertex, and (ii) flag each outgoing edge as either being new or part of 
the original mesh.  (In other words, Step 3 is a great time to set the 
members <code>isNew</code> for vertices and edges created by the split. It is also a good time to copy the <code>newPosition</code> field from the edge being split into the <code>newPosition</code> field of the newly inserted vertex.)</p>

<p>You might try implementing this algorithm in stages, e.g., <em>first</em> see if you can correctly update the connectivity, <em>then</em> worry about getting the vertex positions right. Some examples below illustrate the correct behavior of the algorithm.</p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/SubdivisionExamples.png" alt="Loop subdivision examples" height="435" width="700">
</center><p></p>

<hr>

<h3>Simplification</h3>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/QEMSimplification.png" alt="Surface simplification via quadric error metric" height="222" width="754">
</center><p></p>

<p>Just as with images, meshes often have far more samples than we 
really need.  The simplification method in Scotty3D simplifies a given 
triangle mesh by applying <em>quadric error simplification</em> (note that this method is for <strong>triangle meshes only</strong>!). This method was originally developed at CMU by Michael Garland and Paul Heckbert, in their paper <a href="http://www.cs.cmu.edu/%7E./garland/quadrics/quadrics.html">Surface Simplification Using Quadric Error Metrics</a>.
 (Looking at this paper -- or the many slides and presentations online 
that reference it -- may be very helpful in understanding and 
implementing this part of the assignment!)</p>

<p>The basic idea is to iteratively collapse edges until we reach the 
desired number of triangles.  The more edges we collapse, the simpler 
the mesh becomes.  The only question is: which edges should we collapse?
 And where should we put the new vertex when we collapse an edge? 
Finding the sequence of edge collapses (and vertex positions) that give 
an <em>optimal</em> approximation of the surface would be very difficult
 -- likely impossible! Garland and Heckbert instead proposed a simple, 
greedy scheme that works quite well in practice, and is the basis of 
many mesh simplification tools today. Roughly speaking, we're going to 
write down a function that measures the distance to a given triangle, 
and then "accumulate" this function as many triangles get merged 
together.</p>

<p>More precisely, we can write the distance d of a point <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-83" style="width: 0.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.5em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">x</script> to a plane with normal <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-86" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.88em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.88em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">N</script> passing through a point <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-89" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.49em, 2.778em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.925em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">p</script> as</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-92" style="width: 9.79em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.863em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.504em, 1007.77em, 2.834em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-93"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8901;</span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">p</span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.376em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>N</mi><mo>&#8901;</mo><mo stretchy="false">(</mo><mi>x</mi><mo>&#8722;</mo><mi>p</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-26">d(x) = N \cdot (x - p)</script><p></p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/PlaneNormalEquation.png" alt="Plane normal equation" height="298" width="400">
</center><p></p>

<p>In other words, we measure the extent of the vector from <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-106" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.49em, 2.778em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-107"><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math; font-style: italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.925em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">p</script> to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-109" style="width: 0.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.5em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-110"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">x</script> along the normal direction. This quantity gives us a value that is either <em>positive</em> (above the plane), or <em>negative</em> (below the plane).  Suppose that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-112" style="width: 0.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.5em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">x</script> has coordinates <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-115" style="width: 3.962em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.189em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.504em, 1003.09em, 2.834em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-116"><span class="mo" id="MathJax-Span-117" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.376em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-30">(x,y,z)</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-124" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.88em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.88em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">N</script> has coordinates <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-127" style="width: 3.852em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.079em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.504em, 1002.98em, 2.834em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-128"><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.376em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">(a,b,c)</script>, and let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" style="width: 4.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.959em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.56em, 1003.95em, 2.778em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-141" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8901;</span><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.237em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo>=</mo><mi>N</mi><mo>&#8901;</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">d = N \cdot p</script>, then in <em>homogeneous</em> coordinates, the distance to the plane is just</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-143" style="width: 2.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.76em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.811em, 1001.74em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-144"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8901;</span><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">v</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.699em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>u</mi><mo>&#8901;</mo><mi>v</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-34">u \cdot v</script><p></p>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-148" style="width: 7.536em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.048em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.504em, 1005.95em, 2.834em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-149"><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-152" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-154" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-159" style="font-family: MathJax_Main; padding-left: 0.167em;">1</span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.376em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>z</mi><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-35">u = (x,y,z,1)</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-161" style="width: 7.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.828em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.504em, 1005.73em, 2.834em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-167" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">c</span><span class="mo" id="MathJax-Span-171" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-173" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.376em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>,</mo><mi>c</mi><mo>,</mo><mi>d</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">v = (a,b,c,d)</script>. When we're measuring the quality of an approximation, we don't care whether we're above or below the surface; just how <em>far away</em> we are from the original surface. Therefore, we're going to consider the <em>square</em> of the distance, which we can write in homogeneous coordinates as</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-174" style="width: 9.405em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.588em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.363em, 1007.57em, 2.834em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-175"><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8901;</span><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">v</span><span class="msubsup" id="MathJax-Span-180"><span style="display: inline-block; position: relative; width: 0.818em; height: 0px;"><span style="position: absolute; clip: rect(3.099em, 1000.29em, 4.429em, -1000em); top: -4.014em; left: 0em;"><span class="mo" id="MathJax-Span-181" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.389em;"><span class="mn" id="MathJax-Span-182" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-183" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-184" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.55em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math; font-style: italic;">u</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.572em;"><span class="mi" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mi" id="MathJax-Span-187" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="msubsup" id="MathJax-Span-188"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.47em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.485em;"><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math; font-style: italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.552em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo stretchy="false">(</mo><mi>u</mi><mo>&#8901;</mo><mi>v</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><msup><mi>u</mi><mi>T</mi></msup><mi>v</mi><msup><mi>v</mi><mi>T</mi></msup><mi>u</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-37">(u \cdot v)^2 = u^T v v^T u</script><p></p>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-192" style="width: 0.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.413em, 1000.55em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-193"><span class="msubsup" id="MathJax-Span-194"><span style="display: inline-block; position: relative; width: 0.573em; height: 0px;"><span style="position: absolute; clip: rect(3.849em, 1000em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-195"></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.377em; left: 0em;"><span class="mi" id="MathJax-Span-196" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.18em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi></mi><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-38">^T</script> denotes the transpose of a vector. The term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-197" style="width: 1.927em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.54em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.413em, 1001.54em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-198"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="msubsup" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.47em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.377em; left: 0.485em;"><span class="mi" id="MathJax-Span-202" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.194em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><msup><mi>v</mi><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-39">vv^T</script> is an <a href="https://en.wikipedia.org/wiki/Outer_product">outer product</a> of the vector <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-203" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.811em, 1000.48em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-204"><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.699em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">v</script> with itself, which gives us a symmetric matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-206" style="width: 4.677em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.739em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.413em, 1003.74em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-207"><span class="mi" id="MathJax-Span-208" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">v</span><span class="msubsup" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 1.058em; height: 0px;"><span style="position: absolute; clip: rect(3.406em, 1000.47em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.377em; left: 0.485em;"><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.194em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi><mo>=</mo><mi>v</mi><msup><mi>v</mi><mi>T</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-41">K = vv^T</script>. In components, this matrix would look like</p>

<pre class="prettyprint"><code><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">a</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">^</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">2</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">   ab    ac   ad
ab    b</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">^</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">2</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">   bc   bd
ac    bc    c</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">^</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">2</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">  cd
ad    bd    cd   d</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">^</span></span></span></span></span><span class="lit"><span class="lit"><span class="lit"><span class="lit"><span class="lit">2</span></span></span></span></span></code></pre>

<p>but in Scotty3D it can be constructed by simply calling the method <code>outer( Vector4D, Vector4D )</code> in <code>matrix4x4.h</code>
 that takes a pair of vectors in homogeneous coordinates and returns the
 outer product as a 4x4 matrix. We will refer to this matrix as a 
"quadric," because it also describes a <a href="https://en.wikipedia.org/wiki/Quadric">quadric surface</a>.</p>

<p>The matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-214" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.88em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.88em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-215"><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">K</script> tells us something about the distance to a plane. We can also get some idea of how far we are from a <em>vertex</em>
 by considering the sum of the squared distances to the planes passing 
through all triangles that touch that vertex.  In other words, we will 
say that the distance to a small neighborhood around the vertex i can be
 approximated by the sum of the quadrics on the incident faces ijk:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;all faces ijk touching vertex i&lt;/mtext&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-217" style="width: 16.388em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.196em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.304em, 1013.2em, 3.945em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-218"><span class="msubsup" id="MathJax-Span-219"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.89em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-220" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.849em;"><span class="mi" id="MathJax-Span-221" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-223" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 8.689em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.39em, 4.629em, -1000em); top: -4.014em; left: 3.622em;"><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(3.35em, 1008.67em, 4.425em, -1000em); top: -2.899em; left: 0em;"><span class="texatom" id="MathJax-Span-225"><span class="mrow" id="MathJax-Span-226"><span class="mtext" id="MathJax-Span-227" style="font-size: 70.7%; font-family: MathJax_Main;">all faces ijk touching vertex i</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-228" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.828em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.89em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.849em;"><span class="texatom" id="MathJax-Span-230"><span class="mrow" id="MathJax-Span-231"><span class="mi" id="MathJax-Span-232" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mi" id="MathJax-Span-234" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.756em; border-left: 0px solid; width: 0px; height: 3.002em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><munder><mo>&#8721;</mo><mrow class="MJX-TeXAtom-ORD"><mtext>all faces ijk touching vertex i</mtext></mrow></munder><msub><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-43">K_i = \sum_{\text{all faces ijk touching vertex i}} K_{ijk}</script><p></p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/VertexNormals.png" alt="Vertex normals" height="318" width="325">
</center><p></p>

<p>Likewise, the distance to an <em>edge</em> ij will be approximated by the sum of the quadrics at its two endpoints:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-235" style="width: 7.921em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.378em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1006.38em, 2.879em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-236"><span class="msubsup" id="MathJax-Span-237"><span style="display: inline-block; position: relative; width: 1.459em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.89em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.849em;"><span class="texatom" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="mi" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-244" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.168em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.89em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.849em;"><span class="mi" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-248" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.215em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.89em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.849em;"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.433em; border-left: 0px solid; width: 0px; height: 1.348em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>K</mi><mi>i</mi></msub><mo>+</mo><msub><mi>K</mi><mi>j</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-44">K_{ij} = K_i + K_j</script><p></p>

<p>In your code, we have added a member <code>Matrix4x4 Face::quadric</code> and <code>Matrix4x4 Vertex::quadric</code>
 to the faces and vertices of the halfedge mesh.  The sums above should 
then be easy to compute -- you can just add up the Matrix4x4 objects 
around a vertex or along an edge using the usual "+" operator.  You do 
not need to write an explicit loop over the 16 entries of the matrix.</p>

<p>Once you have a quadric <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-251" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.88em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.88em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-252"><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">K</script> associated with an edge <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-254" style="width: 0.992em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.77em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.593em, 1000.76em, 2.788em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-255"><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math; font-style: italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.321em; border-left: 0px solid; width: 0px; height: 1.209em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">ij</script>, you can ask the following question: if we collapse the edge to a point <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-258" style="width: 0.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.5em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">x</script>,
 where should we put the new point so that it minimizes the 
(approximate) distance to the original surface?  In other words, where 
should it go so that it minimizes the quantity <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-261" style="width: 3.247em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.584em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.413em, 1002.53em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-262"><span class="msubsup" id="MathJax-Span-263"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.52em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.377em; left: 0.572em;"><span class="mi" id="MathJax-Span-265" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.194em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>x</mi><mi>T</mi></msup><mi>K</mi><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">x^T K x</script>?</p>

<p>Just like any other function, we can look for the minimum by taking the derivative with respect to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-268" style="width: 0.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.5em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">x</script> and setting it equal to zero. (By the way, in this case we're always going to get a <em>minimum</em> and not a <em>maximum</em> because the matrices K are all <a href="https://en.wikipedia.org/wiki/Positive-definite_matrix">positive-definite</a>.)  In other words, we want to solve the small (4x4) linear system</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-271" style="width: 4.127em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.299em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1003.26em, 2.606em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-276" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.095em; border-left: 0px solid; width: 0px; height: 1.011em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>K</mi><mi>u</mi><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-50">K u = 0</script><p></p>

<p>for the optimal position <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-277" style="width: 0.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.53em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math; font-style: italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">u</script>,
 expressed in homogeneous coordinates. We can simplify this situation a 
bit by remembering that the homogeneous coordinate for a point in 
3-space is just 1.  After a few simple manipulations, then, we can 
rewrite this same system as an even smaller 3x3 linear system</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-280" style="width: 3.852em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.079em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.538em, 1003.07em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-281"><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.038em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>A</mi><mi>x</mi><mo>=</mo><mi>b</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-52">Ax = b</script><p></p>

<p>where A is the upper-left 3x3 block of K, and b is <em>minus</em> the upper-right 3x1 column.  In other words, the entries of A are just</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-286" style="width: 19.742em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.891em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.487em, 1015.77em, 2.851em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-287"><span class="mrow" id="MathJax-Span-288"><span class="mo" id="MathJax-Span-289" style=""><span style="font-family: MathJax_Main;">[</span></span><span class="mtable" id="MathJax-Span-290" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 14.991em; height: 0px;"><span style="position: absolute; clip: rect(3.082em, 1000.96em, 4.256em, -1000em); top: -4.014em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.015em, 1000.96em, 4.189em, -1000em); top: -3.947em; left: 50%; margin-left: -0.479em;"><span class="mtd" id="MathJax-Span-291"><span class="mrow" id="MathJax-Span-292"><span class="msubsup" id="MathJax-Span-293"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.408em, 1000.51em, 4.189em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.377em; left: 0.529em;"><span class="mn" id="MathJax-Span-295" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(3.222em, 1000.95em, 4.257em, -1000em); top: -4.014em; left: 1.958em;"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1000.95em, 4.19em, -1000em); top: -3.947em; left: 50%; margin-left: -0.479em;"><span class="mtd" id="MathJax-Span-296"><span class="mrow" id="MathJax-Span-297"><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Math; font-style: italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(3.222em, 1002.16em, 4.257em, -1000em); top: -4.014em; left: 3.916em;"><span style="display: inline-block; position: relative; width: 2.17em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1002.16em, 4.19em, -1000em); top: -3.947em; left: 50%; margin-left: -1.085em;"><span class="mtd" id="MathJax-Span-300"><span class="mrow" id="MathJax-Span-301"><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mtext" id="MathJax-Span-304" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math; font-style: italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(3.082em, 1000.86em, 4.257em, -1000em); top: -4.014em; left: 7.086em;"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.015em, 1000.86em, 4.19em, -1000em); top: -3.947em; left: 50%; margin-left: -0.429em;"><span class="mtd" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="msubsup" id="MathJax-Span-309"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1000.42em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.377em; left: 0.429em;"><span class="mn" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(3.222em, 1002.07em, 4.257em, -1000em); top: -4.014em; left: 8.943em;"><span style="display: inline-block; position: relative; width: 2.074em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1002.07em, 4.19em, -1000em); top: -3.947em; left: 50%; margin-left: -1.037em;"><span class="mtd" id="MathJax-Span-312"><span class="mrow" id="MathJax-Span-313"><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mtext" id="MathJax-Span-316" style="font-family: MathJax_Main;">&nbsp;</span><span class="mi" id="MathJax-Span-317" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math; font-style: italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(3.222em, 1000.86em, 4.257em, -1000em); top: -4.014em; left: 12.017em;"><span style="display: inline-block; position: relative; width: 0.862em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1000.86em, 4.19em, -1000em); top: -3.947em; left: 50%; margin-left: -0.431em;"><span class="mtd" id="MathJax-Span-319"><span class="mrow" id="MathJax-Span-320"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math; font-style: italic;">b</span><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Math; font-style: italic;">c</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(3.082em, 1000.86em, 4.257em, -1000em); top: -4.014em; left: 13.879em;"><span style="display: inline-block; position: relative; width: 1.112em; height: 0px;"><span style="position: absolute; clip: rect(3.015em, 1000.86em, 4.19em, -1000em); top: -3.947em; left: 50%; margin-left: -0.556em;"><span class="mtd" id="MathJax-Span-323"><span class="mrow" id="MathJax-Span-324"><span class="msubsup" id="MathJax-Span-325"><span style="display: inline-block; position: relative; width: 0.862em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.43em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Math; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.377em; left: 0.433em;"><span class="mn" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mtext" id="MathJax-Span-328" style="font-family: MathJax_Main;">&nbsp;</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-329" style=""><span style="font-family: MathJax_Main;">]</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.399em; border-left: 0px solid; width: 0px; height: 1.418em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mi>a</mi><mn>2</mn></msup></mtd><mtd><mi>a</mi><mi>b</mi></mtd><mtd><mi>a</mi><mi>c</mi><mtext>&nbsp;</mtext><mi>a</mi><mi>b</mi></mtd><mtd><msup><mi>b</mi><mn>2</mn></msup></mtd><mtd><mi>b</mi><mi>c</mi><mtext>&nbsp;</mtext><mi>a</mi><mi>c</mi></mtd><mtd><mi>b</mi><mi>c</mi></mtd><mtd><msup><mi>c</mi><mn>2</mn></msup><mtext>&nbsp;</mtext></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-53">
\left[
\begin{matrix}
a^2 &  ab  &  ac  \
ab  &  b^2 &  bc  \
ac  &  bc  &  c^2 \
\end{matrix}
\right]
</script><p></p>

<p>and the entries of b are</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-330" style="width: 9.68em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.808em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.504em, 1007.69em, 2.834em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-331"><span class="mrow" id="MathJax-Span-332"><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main;">[</span><span class="mtable" id="MathJax-Span-334" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 6.932em; height: 0px;"><span style="position: absolute; clip: rect(3.205em, 1006.68em, 4.311em, -1000em); top: -4.014em; left: 0em;"><span style="display: inline-block; position: relative; width: 6.932em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1006.68em, 4.261em, -1000em); top: -3.964em; left: 50%; margin-left: -3.466em;"><span class="mtd" id="MathJax-Span-335"><span class="mrow" id="MathJax-Span-336"><span class="mo" id="MathJax-Span-337" style="font-family: MathJax_Main;">&#8722;</span><span class="mi" id="MathJax-Span-338" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-340" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-341" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-344" style="font-family: MathJax_Main;">&nbsp;</span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-346" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">c</span><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mtext" id="MathJax-Span-348" style="font-family: MathJax_Main;">&nbsp;</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main;">]</span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.376em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mo>&#8722;</mo><mi>a</mi><mi>d</mi><mtext>&nbsp;</mtext><mo>&#8722;</mo><mi>b</mi><mi>d</mi><mtext>&nbsp;</mtext><mo>&#8722;</mo><mi>c</mi><mi>d</mi><mtext>&nbsp;</mtext></mtd></mtr></mtable><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-54">
\left[
\begin{matrix}
-ad \
-bd \
-cd \
\end{matrix}
\right]
</script><p></p>

<p>The cost associated with this solution can be found by plugging <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-350" style="width: 0.718em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.812em, 1000.5em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-351"><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.698em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">x</script> back into our original expression, i.e., the cost is just</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-353" style="width: 3.247em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.584em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.363em, 1002.53em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-354"><span class="msubsup" id="MathJax-Span-355"><span style="display: inline-block; position: relative; width: 1.145em; height: 0px;"><span style="position: absolute; clip: rect(3.407em, 1000.52em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -4.427em; left: 0.572em;"><span class="mi" id="MathJax-Span-357" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mi" id="MathJax-Span-359" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 1.256em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>x</mi><mi>T</mi></msup><mi>K</mi><mi>x</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-56">x^T K x</script><p></p>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-360" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.88em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.88em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math; font-style: italic;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">K</script> is the quadric associated with the edge. Fortunately, <em>you do not need to write any code to solve this linear system</em>. It can be solved using the method <code>Matrix3x3::inv()</code> which computes the inverse of a 3x3 matrix. In particular, you can write something like this:</p>

<pre class="prettyprint"><code><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Matrix3x3</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> A</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// computed by accumulating quadrics and then extacting the upper-left 3x3 block</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Vector3D</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> b</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">  </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// computed by extracting minus the upper-right 3x1 column from the same matrix</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Vector3D</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> x </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> A</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">inv</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">()</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">*</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> b</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// solve Ax = b for x, by hitting both sides with the inverse of A</span></span></span></span></span></code></pre>

<p>If you're a bit lost at this point, don't worry! There are a lot of 
details to go through, and we'll summarize everything again in the 
implementation section.  The main idea to keep in mind right now is:</p>

<ul>
<li>we're storing a matrix at every vertex that encodes (roughly) the distance to the surface, and</li>
<li>for each edge, we want to find the point that is (roughly) as close 
as possible to the surface, according to the matrices at its endpoints.</li>
</ul>

<p>As we collapse edges, the matrices at endpoints will be combined by 
just adding them together. So, as we perform more and more edge 
collapses, these matrices will try to capture the distance to a larger 
and larger region of the original surface.</p>

<p>The one final thing we want to think about is performance. At each iteration, we want to collapse the edge that results in the <em>least</em>
 deviation from our original surface. But testing every edge, every 
single iteration sounds pretty expensive! (Something like O(n^2).) 
Instead, we're going to put all our edges into a <a href="https://en.wikipedia.org/wiki/Priority_queue">priority queue</a>
 that efficiently keeps track of the "best" edge for us, even as we add 
and remove edges from our mesh. In the code framework, we actually 
introduce a new class called an <code>EdgeRecord</code> that encodes all the essential information about our edge:</p>

<pre class="prettyprint"><code><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// An edge record keeps track of all the information about edges</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// that we need while applying our mesh simplification algorithm.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">class</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeRecord</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
  </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">public</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">:</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeRecord</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">void</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">)</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">{}</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeRecord</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeIter</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&amp;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> _edge </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// The second constructor takes an edge, and computes all</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// the essential data.  In particular, it computes the sum</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// of the quadrics at the two endpoints, and solves for the</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// optimal midpoint position as measured by this quadric.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// It also stores the value of this quadric as the "score"</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
    </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// used by the priority queue.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

    </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> edge</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// the edge referred to by this record</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

    </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">Vector3D</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> optimalPoint</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// the optimal point, if we were</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
                           </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// to collapse this edge next</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">

    </span></span></span></span></span><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd"><span class="kwd">double</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> cost</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// the cost associated with collapsing this edge,</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
                 </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// which is very (very!) roughly something like</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
                 </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// the distance we'll deviate from the original</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
                 </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// surface if this edge is collapsed</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">};</span></span></span></span></span></code></pre>

<p>To initialize an edge record for a given edge, you just have to write</p>

<pre class="prettyprint"><code><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeRecord</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> myRecord</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">e</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span></code></pre>

<p>In other words, you hand it the edge to be initialized. This record 
in turn gets added to a priority queue, which stores all the halfedges, 
sorted according to the cost of collapsing them:</p>

<pre class="prettyprint"><code><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">MutablePriorityQueue</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> queue</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
queue</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">insert</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">e</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span></code></pre>

<p>If we ever want to know what the best edge is to collapse, we can just look at the top of the priority queue:</p>

<pre class="prettyprint"><code><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeRecord</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> bestEdge </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">=</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> queue</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">.</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">top</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">();</span></span></span></span></span></code></pre>

<p>More documentation is provided in the header file <code>MutablePriorityQueue.h</code>.</p>

<p>Though conceptually sophisticated, quadric error simplification is 
actually not too hard to implement.  It basically boils down to two 
methods:</p>

<pre class="prettyprint"><code><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeRecord</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">::</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeRecord</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">EdgeIter</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> e </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">            </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// initializer for an edge record</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">
</span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">MeshResampler</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">::</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln">downsample</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">(</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="typ"><span class="typ"><span class="typ"><span class="typ"><span class="typ">HalfedgeMesh</span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">&amp;</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> mesh </span></span></span></span></span><span class="pun"><span class="pun"><span class="pun"><span class="pun"><span class="pun">);</span></span></span></span></span><span class="pln"><span class="pln"><span class="pln"><span class="pln"><span class="pln"> </span></span></span></span></span><span class="com"><span class="com"><span class="com"><span class="com"><span class="com">// downsampling via quadric error simplification</span></span></span></span></span></code></pre>

<p>As discussed above, the edge record initializer should:</p>

<ol>
<li>Compute a quadric for the edge as the sum of the quadrics at endpoints.</li>
<li>Build a 3x3 linear system for the optimal collapsed point, as described above.</li>
<li>Solve this system and store the optimal point in <code>EdgeRecord::optimalPoint</code>.</li>
<li>Compute the corresponding error value and store it in <code>EdgeRecord::cost</code>.</li>
<li>Store the edge in <code>EdgeRecord::edge</code>.</li>
</ol>

<p>The downsampling routine can then be implemented by following this basic recipe:</p>

<ol>
<li>Compute quadrics for each face by simply writing the plane equation 
for that face in homogeneous coordinates, and building the corresponding
 quadric matrix using <code>Matrix4x4::outer()</code>.  This matrix should be stored in <code>Face::quadric</code>.</li>
<li>Compute an initial quadric for each vertex by adding up the quadrics
 at all the faces touching that vertex. This matrix should be stored in <code>Vertex::quadric</code>.  (Note that these quadrics will get updated as edges are collapsed.)</li>
<li>For each edge, create an <code>EdgeRecord</code> and insert it into one global <code>MutablePriorityQueue</code>.</li>
<li>Until a target number of triangles is reached, collapse the 
best/cheapest edge (as determined by the priority queue), and set the 
quadric at the new vertex to the sum of the quadrics at the endpoints of
 the original edge.  You will also have to update the cost of any edge 
connected to this vertex.</li>
</ol>

<p>The algorithm should terminate when a target number of triangles is 
reached -- for the purpose of this assignment, you should set this 
number to 1/4th the number of triangles in the input (since subdivision 
will give you a factor of 4 in the opposite direction). Note that to <em>get</em> the best element from the queue you call <code>MutablePriorityQueue::top()</code>, whereas to <em>remove</em> the best element from the top you must call <code>MutablePriorityQueue::pop()</code> (the separation of these two tasks is fairly standard in STL-like data structures).</p>

<p>As with subdivision, it is critical that you carefully reason about 
which mesh elements get added/deleted in what order -- particularly in 
Step 4. A good way to implement Step 4 would be:</p>

<ol>
<li>Get the cheapest edge from the queue.</li>
<li><strong>Remove the cheapest edge from the queue by calling <code>pop()</code>.</strong></li>
<li>Compute the new quadric by summing the quadrics at its two endpoints.</li>
<li><strong>Remove any edge touching either of its endpoints from the queue.</strong></li>
<li>Collapse the edge.</li>
<li>Set the quadric of the new vertex to the quadric computed in Step 2.</li>
<li><strong>Insert any edge touching the new vertex into the queue, creating new edge records for each of them.</strong></li>
</ol>

<p><em>Note:</em> Step 2 is highlighted, because these instruction used 
to erroneously recommend that the pop be done at the end. The pop of the
 cheapest edge needs to occur before any modifications are made to the 
queue, because otherwise the edge you are processing might not be the 
cheapest edge at the end of the 7 step process.</p>

<p>Steps 4 and 7 are highlighted because it is easy to get these steps 
wrong. For instance, if you collapse the edge first, you may no longer 
be able to access the edges that need to be removed from the queue.</p>

<p>A working implementation should look something like the examples 
below. You may find it easiest to implement this algorithm in stages.  
For instance, <em>first</em> get the edge collapses working, using just the edge midpoint rather than the optimal point, <em>then</em> worry about solving for the point that minimizes quadric error.</p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/QEMExamples.png" alt="Quadric error simplification examples" height="700" width="600">
</center><p></p>

<h3>Isotropic Remeshing</h3>

<p>Another thing we might want to do with a mesh is keep the number of 
samples roughly the same, while improving the shape of individual 
triangles. The isotropic remeshing algorithm tries to make the mesh as 
"uniform" as possible, i.e., triangles as close as possible to 
equilaterial triangles of equal size, and vertex degrees as close as 
possible to 6 (note: this algorithm is for <strong>triangle meshes only</strong>).  The algorithm you will implement is based on the paper <a href="http://graphics.uni-bielefeld.de/publications/disclaimer.php?dlurl=sgp04.pdf">Botsch and Kobbelt, "A Remeshing Approach to Multiresolution Modeling"</a> (Section 4), and can be summarized in just a few simple steps:</p>

<ol>
<li>If an edge is too long, split it.</li>
<li>If an edge is too short, collapse it.</li>
<li>If flipping an edge improves the degree of neighboring vertices, flip it.</li>
<li>Move vertices toward the average of their neighbors.</li>
</ol>

<p>Repeating this simple process several times typically produces a mesh
 with fairly uniform triangle areas, angles, and vertex degrees. 
However, each of the steps deserves slightly more explanation.</p>

<h4>Edge Splitting / Collapsing</h4>

<p>Ultimately we want all of our triangles to be about the same size, 
which means we want edges to all have roughly the same length. As 
suggested in the paper by Botsch and Kobbelt, we will aim to keep our 
edges no longer than 4/3rds of the <strong>mean</strong> edge length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-363" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.66em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.63em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-364"><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">L</script> in the input mesh, and no shorter than 4/5ths of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-366" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.66em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.63em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-367"><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-59">L</script>. In other words, if an edge is longer than 4<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-369" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.66em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.63em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">L</script>/3, split it; if it is shorter than 4<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-372" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.66em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.63em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-373"><span class="mi" id="MathJax-Span-374" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-61">L</script>/5,
 collapse it. We recommend performing all of the splits first, then 
doing all of the collapses (though as usual, you should be careful to 
think about when and how mesh elements are being allocated/deallocated).</p>

<h4>Edge Flipping</h4>

<p>We want to flip an edge any time it reduces the total deviation from regular degree (degree 6). In particular, let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-375" style="width: 1.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.935em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.813em, 1000.93em, 2.734em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-376"><span class="msubsup" id="MathJax-Span-377"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.408em, 1000.51em, 4.189em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.529em;"><span class="mn" id="MathJax-Span-379" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.254em; border-left: 0px solid; width: 0px; height: 0.869em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-62">a_1</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-380" style="width: 1.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.935em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.813em, 1000.93em, 2.734em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-381"><span class="msubsup" id="MathJax-Span-382"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.408em, 1000.51em, 4.189em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-383" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.529em;"><span class="mn" id="MathJax-Span-384" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.254em; border-left: 0px solid; width: 0px; height: 0.869em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-63">a_2</script> be the degrees of an edge that we're thinking about flipping, and let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-385" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.88em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.56em, 1000.88em, 2.734em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-386"><span class="msubsup" id="MathJax-Span-387"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1000.42em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.429em;"><span class="mn" id="MathJax-Span-389" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.254em; border-left: 0px solid; width: 0px; height: 1.183em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-64">b_1</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-390" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.88em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.56em, 1000.88em, 2.734em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-391"><span class="msubsup" id="MathJax-Span-392"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1000.42em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.429em;"><span class="mn" id="MathJax-Span-394" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.254em; border-left: 0px solid; width: 0px; height: 1.183em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-65">b_2</script> be the degrees of the two vertices across from this edge. The total deviation in the initial configuration is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-395" style="width: 20.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.386em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.504em, 1016.27em, 2.833em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-396"><span class="texatom" id="MathJax-Span-397"><span class="mrow" id="MathJax-Span-398"><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-400"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.408em, 1000.51em, 4.189em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.529em;"><span class="mn" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-403" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mn" id="MathJax-Span-404" style="font-family: MathJax_Main; padding-left: 0.222em;">6</span><span class="texatom" id="MathJax-Span-405"><span class="mrow" id="MathJax-Span-406"><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="texatom" id="MathJax-Span-409" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-410"><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-412"><span style="display: inline-block; position: relative; width: 0.958em; height: 0px;"><span style="position: absolute; clip: rect(3.408em, 1000.51em, 4.189em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math; font-style: italic;">a</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.529em;"><span class="mn" id="MathJax-Span-414" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mn" id="MathJax-Span-416" style="font-family: MathJax_Main; padding-left: 0.222em;">6</span><span class="texatom" id="MathJax-Span-417"><span class="mrow" id="MathJax-Span-418"><span class="mo" id="MathJax-Span-419" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="texatom" id="MathJax-Span-421" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-422"><span class="mo" id="MathJax-Span-423" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-424"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1000.42em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.429em;"><span class="mn" id="MathJax-Span-426" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mn" id="MathJax-Span-428" style="font-family: MathJax_Main; padding-left: 0.222em;">6</span><span class="texatom" id="MathJax-Span-429"><span class="mrow" id="MathJax-Span-430"><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="texatom" id="MathJax-Span-433" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-434"><span class="mo" id="MathJax-Span-435" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-436"><span style="display: inline-block; position: relative; width: 0.858em; height: 0px;"><span style="position: absolute; clip: rect(3.155em, 1000.42em, 4.19em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math; font-style: italic;">b</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.429em;"><span class="mn" id="MathJax-Span-438" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="mo" id="MathJax-Span-439" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mn" id="MathJax-Span-440" style="font-family: MathJax_Main; padding-left: 0.222em;">6</span><span class="texatom" id="MathJax-Span-441"><span class="mrow" id="MathJax-Span-442"><span class="mo" id="MathJax-Span-443" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.377em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>a</mi><mn>1</mn></msub><mo>&#8722;</mo><mn>6</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>a</mi><mn>2</mn></msub><mo>&#8722;</mo><mn>6</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>b</mi><mn>1</mn></msub><mo>&#8722;</mo><mn>6</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>b</mi><mn>2</mn></msub><mo>&#8722;</mo><mn>6</mn><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-66">|a_1-6| + |a_2-6| + |b_1-6| + |b_2-6|</script>. You should be able to <em>easily</em> compute the deviation after the edge flip <strong>without actually performing the edge flip</strong>;
 if this number decreases, then the edge flip should be performed. We 
recommend flipping all edges in a single pass, after the edge collapse 
step.</p>

<h4>Vertex Averaging</h4>

<p>Finally, we also want to optimize the geometry of the vertices. A 
very simple heuristic is that a mesh will have reasonably well-shaped 
elements if each vertex is located at the center of its neighbors. To 
keep your code clean and simple, we ask that you implement the method <code>Vertex::computeCentroid()</code> which should compute the average position of the neighbors and store it in the member <code>Vertex::centroid</code>. The reason this value must be stored in a temporary variable and not <em>immediately</em>
 used to replace the current position is similar to the reason we stored
 temporary vertex positions in our subdivision scheme: we don't want to 
be taking averages of vertices that have already been averaged. Doing so
 can yield some bizarre behavior that depends on the order in which 
vertices are traversed (if you're interested in learning more about this
 issue, Google around for the terms "Jacobi iterations" and 
"Gauss-Seidel). So, your code should (i) first compute the centroid for 
all vertices, and (ii) then update the vertices with new positions.</p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/LaplacianSmoothing.png" alt="Laplacian smoothing" height="183" width="500">
</center><p></p>

<p>How exactly should the positions be updated?  One idea is to simply 
replace each vertex position with its centroid.  We can make the 
algorithm slightly more stable by moving <em>gently</em> toward the centroid, rather than immediately snapping the vertex to the center. For instance, if <strong>p</strong> is the original vertex position and <strong>c</strong> is the centroid, we might compute the new vertex position as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-444" style="width: 8.91em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.148em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.504em, 1007.05em, 2.834em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math; font-style: italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-448" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">p</span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">w</span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mo" id="MathJax-Span-453" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">p</span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.376em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi><mo>=</mo><mi>p</mi><mo>+</mo><mi>w</mi><mo stretchy="false">(</mo><mi>c</mi><mo>&#8722;</mo><mi>p</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-67">q = p + w(c - p)</script> where w is some weighting factor between 0 and 1 (we use 1/5 in the examples below). In other words, we start out at <strong>p</strong> and move a little bit in the update direction <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-456" style="width: 4.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.959em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.671em, 1003.95em, 2.778em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-457"><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">c</span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">p</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.1em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>=</mo><mi>c</mi><mo>&#8722;</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-68">v = c - p</script>.</p>

<p>Another important issue here is that if our update direction <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-463" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.811em, 1000.48em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Math; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.699em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-69">v</script> has a large <em>normal</em>
 component, then we'll end up pushing the surface in or out, rather than
 just sliding our sample points around on the surface.  As a result, the
 shape of the surface will change much more than we'd like (try it!).  
To ameliorate this issue, we will move the vertex only in the <em>tangent</em> direction, which we can do by projecting out the normal component, i.e., by replacing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-466" style="width: 0.608em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.811em, 1000.48em, 2.595em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-467"><span class="mi" id="MathJax-Span-468" style="font-family: MathJax_Math; font-style: italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.082em; border-left: 0px solid; width: 0px; height: 0.699em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">v</script> with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-469" style="width: 6.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.444em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.504em, 1005.44em, 2.834em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-family: MathJax_Math; font-style: italic;">v</span><span class="mo" id="MathJax-Span-472" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8722;</span><span class="mo" id="MathJax-Span-473" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-475" style="font-family: MathJax_Main; padding-left: 0.222em;">&#8901;</span><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">v</span><span class="mo" id="MathJax-Span-477" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.378em; border-left: 0px solid; width: 0px; height: 1.376em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>&#8722;</mo><mo stretchy="false">(</mo><mi>N</mi><mo>&#8901;</mo><mi>v</mi><mo stretchy="false">)</mo><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">v - (N \cdot v)N</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-479" style="width: 1.102em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.88em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.88em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-480"><span class="mi" id="MathJax-Span-481" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-72">N</script> is the unit normal at the vertex.  To get this normal, you will implement the method <code>Vertex::normal()</code>,
 which computes the vertex normal as the area-weighted average of the 
incident triangle normals.  In other words, at a vertex i the normal 
points in the direction</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span></p><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;triangles ijk touching vertex i&lt;/mtext&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-482" style="width: 15.619em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.592em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.304em, 1012.59em, 3.937em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-483"><span class="munderover" id="MathJax-Span-484"><span style="display: inline-block; position: relative; width: 8.927em; height: 0px;"><span style="position: absolute; clip: rect(2.899em, 1001.39em, 4.629em, -1000em); top: -4.014em; left: 3.742em;"><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Size2; vertical-align: 0em;">&#8721;</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1008.91em, 4.425em, -1000em); top: -2.907em; left: 0em;"><span class="texatom" id="MathJax-Span-486"><span class="mrow" id="MathJax-Span-487"><span class="mtext" id="MathJax-Span-488" style="font-size: 70.7%; font-family: MathJax_Main;">triangles ijk touching vertex i</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-489" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.133em, 1000.73em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.75em;"><span class="texatom" id="MathJax-Span-491"><span class="mrow" id="MathJax-Span-492"><span class="mi" id="MathJax-Span-493" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-494" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mi" id="MathJax-Span-495" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-496"><span style="display: inline-block; position: relative; width: 1.782em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.89em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.803em;"><span class="texatom" id="MathJax-Span-498"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-501" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mi" id="MathJax-Span-502" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.746em; border-left: 0px solid; width: 0px; height: 2.992em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><munder><mo>&#8721;</mo><mrow class="MJX-TeXAtom-ORD"><mtext>triangles ijk touching vertex i</mtext></mrow></munder><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub><msub><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-73">\sum_{\text{triangles ijk touching vertex i}} A_{ijk} N_{ijk}</script><p></p>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-503" style="width: 2.147em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.705em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.538em, 1001.71em, 2.879em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-504"><span class="msubsup" id="MathJax-Span-505"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.133em, 1000.73em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.75em;"><span class="texatom" id="MathJax-Span-507"><span class="mrow" id="MathJax-Span-508"><span class="mi" id="MathJax-Span-509" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-510" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mi" id="MathJax-Span-511" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.433em; border-left: 0px solid; width: 0px; height: 1.389em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-74">A_{ijk}</script> is the area of triangle ijk, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-512" style="width: 2.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.76em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1001.76em, 2.879em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-513"><span class="msubsup" id="MathJax-Span-514"><span style="display: inline-block; position: relative; width: 1.782em; height: 0px;"><span style="position: absolute; clip: rect(3.166em, 1000.89em, 4.179em, -1000em); top: -4.014em; left: 0em;"><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span><span style="position: absolute; top: -3.864em; left: 0.803em;"><span class="texatom" id="MathJax-Span-516"><span class="mrow" id="MathJax-Span-517"><span class="mi" id="MathJax-Span-518" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-519" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">j</span><span class="mi" id="MathJax-Span-520" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span></span></span><span style="display: inline-block; width: 0px; height: 4.014em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.433em; border-left: 0px solid; width: 0px; height: 1.348em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>N</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi><mi>k</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-75">N_{ijk}</script>
 is its unit normal; this quantity can be computed directly by just 
taking the cross product of two of the triangle's edge vectors (properly
 oriented).</p>

<h4>Implementation</h4>

<p>The final implementation requires very little information beyond the description above; the basic recipe is:</p>

<ol>
<li>Compute the mean edge length <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-521" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.66em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.63em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-522"><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">L</script> of the input.</li>
<li>Split all edges that are longer than 4<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-524" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.66em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.63em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">L</script>/3.</li>
<li>Collapse all edges that are shorter than 4<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-527" style="width: 0.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.66em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.571em, 1000.63em, 2.584em, -1000em); top: -2.419em; left: 0em;"><span class="mrow" id="MathJax-Span-528"><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.419em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.983em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">L</script>/5.</li>
<li>Flip all edges that decrease the total deviation from degree 6.</li>
<li>Compute the centroids for all the vertices.</li>
<li>Move each vertex in the tangent direction toward its centroid.</li>
</ol>

<p>Repeating this procedure about 5 or 6 times should yield results like
 the ones seen below; you may want to repeat the smoothing step 10-20 
times for each "outer" iteration.</p>

<p></p><center>
<img src="Assignment2_DeveloperManual_files/IsotropicExamples.png" alt="Isotropic remeshing examples" height="637" width="700">
</center><p></p>































































































































































































</div>




</div>

<hr size="1">

<div class="footer">
     Copyright 2017 Carnegie Mellon University
</div>


</div>  <!-- end of content_container (defined in header.php) -->
</div>  <!-- end main_container (defined in header.php) -->





<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size2,sans-serif;"></div></div></body></html>